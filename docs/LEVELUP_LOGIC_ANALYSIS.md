# 레벨업 로직 분석 보고서

## 현재 구현 상태

### 레벨업 시 능력치 증가 로직
- 레벨업 감지 시, 이전 레벨 동안의 활동을 조회
- 해당 레벨 범위에서 활동한 카테고리별로 능력치 +1 증가
- 예: 레벨 9→10 상승 시, 레벨 9 동안 학습/운동을 했다면 INT +1, STR +1

## 기존 사용자 영향 분석

### 시나리오 1: 기존 사용자 (이미 레벨 10 이상)
- **문제 없음** ✅
- 이유: 레벨업 로직은 **이전 레벨**의 활동만 확인
- 예: 레벨 10→11 상승 시, 레벨 10 동안의 활동만 체크
- 과거 레벨(1-9)의 활동은 무시됨

### 시나리오 2: 신규 사용자
- **정상 작동** ✅
- 매 레벨업마다 해당 레벨의 활동 기반으로 능력치 증가
- 일관된 보상 시스템

## 기존 사용자 데이터 호환성

### 능력치 계산 방식
1. **기존 방식**: 활동 시마다 XP 기반으로 능력치 증가
   - 10 XP당 1 능력치 포인트
   - 카테고리에 따라 특정 능력치 증가

2. **새 방식**: 기존 방식 + 레벨업 보너스
   - 활동 시: 기존과 동일 (XP 기반 증가)
   - 레벨업 시: 추가 보너스 (활동 카테고리별 +1)

### 중복 보상 여부
- **중복 없음** ✅
- 레벨업 보너스는 각 레벨당 1회만 적용
- `previousLevel < level` 조건으로 중복 방지

## 결론

**기존 사용자 초기화 불필요**

### 이유:
1. 레벨업 로직은 항상 "이전 레벨" 범위만 확인
2. 이미 지나간 레벨에 대한 중복 보상 없음
3. 기존 사용자도 다음 레벨업부터 새 보너스 적용
4. 데이터 일관성 유지됨

### 권장사항:
- 현재 로직 유지
- 기존 사용자 데이터 초기화 불필요
- 모든 사용자에게 공평한 보상 시스템

## 테스트 시나리오

```typescript
// 예시: 레벨 15인 기존 사용자
// 총 XP: 2000 -> 2100 (레벨 16 도달)

// 1. 레벨 15의 XP 범위 계산
// minXP: 1900, maxXP: 2099

// 2. 해당 범위의 활동만 조회
// 최근 활동들 중 XP 1900-2099 구간의 활동

// 3. 해당 활동의 카테고리별 능력치 +1
// 과거 레벨(1-14)은 영향 없음
```